<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="zh">
<head th:replace="fragment/globalComponent::commonHead(~{::title},~{::link},~{::style})">
    <title>GoblinCwl - 首页</title>
    <!--手表时钟-->
    <link th:href="@{/plugins/watchClock/style.css}" rel="stylesheet">
    <style>
        .timeStampSHow {
            color: #929e98;
        }

        div {
            overflow-x: hidden;
            overflow-y: auto;
        }

        html {
            position: relative;
            min-height: 100%;
        }

        .web-record {
            font-size: 0.8em;
            color: gray;
        }

        .web-record p {
            text-align: center;
            font-family: MyHack;
        }

        .web-record a {
            color: gray;
        }

        @media (max-width: 768px) {
            .web-record p {
                margin: 0;
            }
        }

        input:focus {
            outline: none;
            border: 0;
            box-shadow: 0 0 0;
        }

        html .console {
            margin-left: 0.5rem;
            /*box-shadow: 0 0 15px 0px rgba(0, 0, 0, 0.35);*/
            box-shadow: -5px 5px 10px -6px rgba(0, 0, 0, 0.35), 5px 0 10px -6px rgba(0, 0, 0, 0.35);
            border: 1px solid black;
            border-top: 0;
        }

        .top {
            text-align: center;
            font-size: 16px;
            padding: 5px;
            background-color: #6ecadc;
            color: white;
            width: 98%;
            float: left;
            margin-left: 0.5rem;
            margin-top: 2rem;
            /*box-shadow: -5px -5px 10px -6px rgba(0, 0, 0, 0.35), 5px 0 10px -6px rgba(0, 0, 0, 0.35);*/
            border: 1px solid #5396a3;
        }

        .top .options {
            font-size: 16px;
            float: right;
        }

        html .console .text {
            font-family: 'MyHack';
            color: #000000;
            font-size: 14px;
            padding: 0.25rem;
        }

        .terminal-console {
            width: 98%;
            float: left;
            height: 33em;
        }

        @media (max-width: 640px) {
            html .console {
                margin-left: 0;
            }

            .terminal-console {
                width: 100%;
            }

            .top {
                width: 100%;
                margin-top: 1rem;
                margin-left: 0;
            }
        }

        .indexRightDiv {
            padding: 0;
            border: 5px solid;
            height: 33.33%;
        }

        #updateBlogTable {
            border-collapse: unset;
        }

        #updateBlogTable tbody tr td {
            border-bottom: 1px grey solid;

        }

        #updateBlogTable tbody tr td a {
            color: #c08734;

        }

        .blogTdTime {
            text-align: right;
            font-size: small;
            color: grey;
        }

    </style>
    <style>
        .rightWeatherDiv {
            height: 50%;
            padding: 0;
        }

        #recentCodeLagTable {
            border-collapse: unset
        }

        #recentCodeLagTable td {
            padding: 0.3em;
        }

        @keyframes typing15 {
            from {
                width: 0;
            }
            50% {
                width: 15ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing14 {
            from {
                width: 0;
            }
            50% {
                width: 14ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing13 {
            from {
                width: 0;
            }
            50% {
                width: 13ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing12 {
            from {
                width: 0;
            }
            50% {
                width: 12ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing11 {
            from {
                width: 0;
            }
            50% {
                width: 11ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing10 {
            from {
                width: 0;
            }
            50% {
                width: 10ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing9 {
            from {
                width: 0;
            }
            50% {
                width: 9ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing8 {
            from {
                width: 0;
            }
            50% {
                width: 8ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing7 {
            from {
                width: 0;
            }
            50% {
                width: 7ch;
            }
            100% {
                width: 0
            }
        }


        @keyframes typing6 {
            from {
                width: 0;
            }
            50% {
                width: 6ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing5 {
            from {
                width: 0;
            }
            50% {
                width: 5ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes typing4 {
            from {
                width: 0;
            }
            50% {
                width: 4ch;
            }
            100% {
                width: 0
            }
        }

        @keyframes caret {
            50% {
                border-color: transparent;
            }
        }

        #autoTypeDiv {
            width: 0;
            animation: typing 6s steps(15) infinite, caret 1s steps(1) infinite;
            white-space: nowrap;
            overflow: hidden;
            border-right: .05em solid;
            font-family: Consolas, Monaco, monospace;
            color: blue;
        }

        .QRCodeImg {
            width: 7em;
            cursor: pointer;
        }

        .flowerPeace {
            position: absolute;
        }

        #Marigold_petals, #Marigold_head, #Marigold_mouth, #Marigold_eyebrow1, #Marigold_eyebrow2, #Marigold_blink1, #Marigold_blink2 {
            animation: flowerHead 0.8s infinite alternate;
        }

        #PeaShooter_stalk_bottom {
            animation: flowerRotate 0.8s infinite alternate;
        }

        #PeaShooter_frontleaf_righttip, #PeaShooter_backleaf_righttip {
            animation: flowerRotate2 0.8s infinite alternate;
        }

        #PeaShooter_frontleaf_lefttip, #PeaShooter_backleaf_lefttip {
            animation: flowerRotate3 0.8s infinite alternate;
        }

        #PeaShooter_frontleaf, #PeaShooter_backleaf {
            animation: flowerScale 0.8s infinite alternate;
        }

        @keyframes flowerHead {
            0% {
                transform: translateX(-2px) translateY(2px);
            }
            50% {
                transform: translateX(0px) translateY(0px);
            }
            100% {
                transform: translateX(2px) translateY(2px)
            }
        }

        @keyframes flowerRotate {
            0% {
                transform: rotate(-10deg);
            }
            50% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(10deg);
            }
        }

        @keyframes flowerRotate2 {
            0% {
                transform: rotate(5deg) scale(1.05);
            }
            25% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(-5deg);
            }
            75% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(5deg) scale(1.0);
            }
        }

        @keyframes flowerRotate3 {
            0% {
                transform: rotate(10deg) scale(1.05);
            }
            25% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(-10deg);
            }
            75% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(10deg) scale(1.0);
            }
        }

        @keyframes flowerScale {
            0% {
                transform: scale(1.05)
            }
            100% {
                transform: scale(1.0)
            }
        }

        #goldImgPick {
            width: 3em;
            position: absolute;
            left: 50%;
            top: 92%;
            z-index: 9999;
            filter: drop-shadow(0px 0px 10px #ffe91f);
            cursor: pointer;
            animation: pickGold 0.5s;
            animation-fill-mode: forwards;
            visibility: hidden;
            animation-play-state: paused;
        }

        @keyframes pickGold {
            99% {
                transform: scale(0.5) translateY(-210px) translateX(20px);
            }
            100% {
                transform: scale(0.5) translateY(-210px) translateX(20px);
                visibility: hidden;
            }


        }
    </style>
</head>
<body>
<!-- 左侧侧边栏 -->
<div th:replace="fragment/globalComponent::leftSiderBar"></div>


<!-- 页面内容 -->
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <div class="content">
        <!-- 顶部导航 -->
        <div th:replace="fragment/globalComponent::topHeader"></div>

        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-6">
                    <!--终端-->
                    <div class="top">
                        <span class="options">○ ○ ⦿</span>
                        <span class="title">GoblinCwl - 终端</span>
                    </div>
                    <div id="terminal-console" class="console terminal-console">
                        <div id="terminalDiv" class="text">
                            <p id="consoleInput">
                                <label id="chatInputLabel" for="chatInput" style="color: #2bd92b">
                                    [<span id="nickName">unAuth</span>@goblincwl.cn] #

                                </label>
                                <input id="chatInput" type="text"
                                       style="background-color:transparent;border:0;outline:none;"
                                       name="t2"
                                       value=""/>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5">
                    <div style="height: 35em;border: 1px solid #000;margin-top: 2rem">
                        <div id="timeDateDiv" class="col-lg-4 indexRightDiv"
                             style="border-color:hsl(120, 30%, 58%);width: 38%;height: 33.33%">
                            <button aria-label="Previous Gadget" class="svelte-1x9sc7x1"
                                    onclick="$($('nav button')[0]).trigger('click')"
                                    style="position: absolute;width: 1em;height: 2em;background: red;left: 80%;top: 25%;border-radius: 1em"></button>
                        </div>
                        <div class="indexRightDiv" style="border-color: #6eDadc">
                            <div style="border: 1px solid black;height: 100%">
                                <div class="rightWeatherDiv col-lg-6">
                                    <div class="rightWeatherDiv col-lg-12"
                                         style="text-align: center;padding: 0.6em;border-bottom: 1px dashed #000">
                                        <div id="autoTypeDiv" class="autoTypeDiv">
                                            <!--打字机动画-->
                                        </div>
                                    </div>
                                    <div class="rightWeatherDiv col-lg-12"
                                         style="border-bottom: 1px solid;text-align: center;">
                                        <div class="rightWeatherDiv col-lg-12">
                                            <span id="yesterdayWorkTimeSpan"
                                                  style="font-size: 8px;color:rgba(65,127,218,0.68)">
                                                <!--昨日工时-->
                                            </span>
                                        </div>
                                        <div class="rightWeatherDiv col-lg-12">
                                            <span id="todayWorkTimeSpan"
                                                  style="font-size: 15px;font-weight: bold;color: #417fda">
                                                <!--今日工时-->
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="rightWeatherDiv col-lg-3"
                                     style="text-align: center;padding-top: 0.5em;background-color: #c3ecec;border-left:solid 1px #000;border-bottom: 1px #000 solid">
                                    <div class="col-lg-12">
                                        <span id="provinceSpan" style="color: #446eb9;font-weight: bold">
                                            <!--省份信息-->
                                        </span>
                                    </div>
                                    <div class="col-lg-12">
                                        <span id="citySpan" style="color: cornflowerblue">
                                            <!--城市信息-->
                                        </span>
                                    </div>
                                    <div class="col-lg-12">
                                        <em id="stateSpan" style="color: red;font-size: small">
                                            <!--状态信息-->
                                        </em>
                                    </div>
                                </div>
                                <div class="rightWeatherDiv col-lg-3"
                                     style="text-align: center;background-color: #c3ecec;border-left:dashed 1px grey;border-bottom: 1px #000 solid">
                                    <img id="weatherTempImg" style="width: 100%;padding: 0.7em 0.8em 0;">
                                    <span id="weatherTempSpan"
                                          style="font-size: small;color: dodgerblue;position: absolute;bottom: 0.5em;transform: translate(-50%);left: 50%;width: 100%;">
                                        <!--天气-温度-->
                                    </span>
                                </div>
                                <div class="rightWeatherDiv col-lg-12">
                                    <table id="recentCodeLagTable" style="height:100%;width:100%;font-size: 12px;">
                                        <thead style="background-color: #6EdADC;">
                                        <td style="width: 15%; border-bottom: 1px solid #000"></td>
                                        <td style="width: 35%; border-bottom: 1px solid #000"></td>
                                        <td style="width: 15%; border-bottom: 1px solid #000"></td>
                                        <td style="width: 35%; border-bottom: 1px solid #000"></td>
                                        </thead>
                                        <tbody>
                                        <tr style="white-space: nowrap;text-overflow: ellipsis">
                                            <td>
                                                <span id="languageSpan1"></span>
                                            </td>
                                            <td>
                                                <div id="languageDiv1"
                                                     style="background-color: #6ecadc;display: inline-block;height: 12px;"></div>
                                            </td>
                                            <td><span id="languageSpan2"></span></td>
                                            <td>
                                                <div id="languageDiv2"
                                                     style="background-color: #6ecadc;display: inline-block;height: 12px;"></div>
                                            </td>
                                        </tr>
                                        <tr style="white-space: nowrap;text-overflow: ellipsis">
                                            <td>
                                                <span id="languageSpan3"></span>
                                            </td>
                                            <td>
                                                <div id="languageDiv3"
                                                     style="background-color: #6ecadc;display: inline-block;height: 12px;"></div>
                                            </td>
                                            <td><span id="languageSpan4"></span></td>
                                            <td>
                                                <div id="languageDiv4"
                                                     style="background-color: #6ecadc;display: inline-block;height: 12px;"></div>
                                            </td>
                                        </tr>
                                        <tr style="white-space: nowrap;text-overflow: ellipsis">
                                            <td>
                                                <span id="languageSpan5"></span>
                                            </td>
                                            <td>
                                                <div id="languageDiv5"
                                                     style="background-color: #6ecadc;display: inline-block;height: 12px;"></div>
                                            </td>
                                            <td><span id="languageSpan6"></span></td>
                                            <td>
                                                <div id="languageDiv6"
                                                     style="background-color: #6ecadc;display: inline-block;height: 12px;"></div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 indexRightDiv" style="border-color: #e1b037;height: 40%">
                            <div style="border: 1px solid black;height: 100%;padding: 0.45em">
                                <table style="width: 100%;height: 100%;" id="updateBlogTable">
                                    <thead>
                                    <td style="width: 89%"></td>
                                    <td style="width: 11%"></td>
                                    </thead>
                                    <tbody id=updateBlogTbody>
                                    <!--最近更新的博客-->
                                </table>
                            </div>
                        </div>
                        <div class="col-lg-1 indexRightDiv" style="border-color: #fed547;width: 15.1%;height: 26.6%">
                            <div style="height: 20%;border: 1px solid #000;padding: 0.1em">
                                <img id="goldImg" th:src="@{images/flower/Gold.png}"
                                     style="height: 100%;" title="产自金盏花的贵重黄金！">
                                <span id="goldCountSpan"
                                      style="font-family: SpacePixel,serif;font-size: 13px"
                                      title="产自金盏花的贵重黄金！">
                                    <!--总浇水次数-->
                                </span>
                            </div>
                            <div style="background: #fed547;height: 5px;"></div>
                            <div id="flowerDiv"
                                 style="border: 1px solid black;height: 76.5%;padding: 0.4em;background-color: #faff8b">
                                <img id="Marigold_petals" style="width: 50px;z-index: 10;left: 12px;top: 37px"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_petals.png}">
                                <img id="Marigold_head" style="width: 30px;z-index:11;left: 24px;top: 48px;"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_head.png}">
                                <img id="Marigold_blink1"
                                     style="width: 24px;z-index:11;left: 28px;top: 53px;visibility: hidden"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_blink1.png}">
                                <img id="Marigold_blink2"
                                     style="width: 24px;z-index:11;left: 28px;top: 53px;visibility: hidden"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_blink2.png}">
                                <img id="Marigold_mouth" style="z-index:12;left: 31px;top: 63px;width: 20px;"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_mouth.png}">
                                <img id="Marigold_eyebrow1" style="z-index:12;top: 52px;left: 27px;width: 8px"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_eyebrow1.png}">
                                <img id="Marigold_eyebrow2" style="z-index:12;top: 50px;left: 43px;width: 8px"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Marigold_eyebrow2.png}">
                                <img id="PeaShooter_backleaf" style="z-index: 8;width: 25px;top: 86px;left: 22px;"
                                     class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_backleaf.png}">
                                <img id="PeaShooter_frontleaf" style="z-index: 12;top: 84px;left: 14px;width: 45px;"
                                     class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_frontleaf.png}">
                                <img id="PeaShooter_stalk_bottom" style="top: 84px;left: 32px;z-index: 8;width: 10px"
                                     class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_stalk_bottom.png}">
                                <img id="PeaShooter_frontleaf_lefttip"
                                     style="top: 91px;left: 10px;z-index: 8;width: 16px" class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_frontleaf_lefttip.png}">
                                <img id="PeaShooter_frontleaf_righttip"
                                     style="top: 85px;left: 55px;z-index: 8;width: 10px" class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_frontleaf_righttip.png}">
                                <img id="PeaShooter_backleaf_lefttip"
                                     style="top: 86px;left: 19px;z-index: 8;width: 10px" class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_backleaf_lefttip.png}">
                                <img id="PeaShooter_backleaf_righttip"
                                     style="top: 85px;left: 42px;z-index: 8;width: 10px" class="flowerPeace"
                                     th:src="@{images/flower/PeaShooter_backleaf_righttip.png}">
                                <img id="Pot_top" style="top: 83px;left: 8px;z-index: 7;width: 57px" class="flowerPeace"
                                     th:src="@{images/flower/Pot_top.png}">
                                <img id="Pot_bottom" style="top: 117px;left: 13px;z-index: 6;width: 48px"
                                     class="flowerPeace"
                                     th:src="@{images/flower/Pot_bottom.png}">

                            </div>
                        </div>
                        <div class="indexRightDiv" style="border-color: #ef9bd5;;height: 26.6%">
                            <div style="border: 1px solid black;height: 100%">
                                <div>
                                    <a target="_blank"
                                       href="https://qm.qq.com/cgi-bin/qm/qr?k=39jFphuNXTzdb_aHQaUMKj9DARpvfRf7&noverify=0&personal_qrcode_source=4"><img
                                            class="QRCodeImg" th:src="@{/images/QRCode/QQ.png}"></a>
                                    <a target="_blank" href="https://u.wechat.com/MHcajFb03bKan0E5HfO06wc"><img
                                            class="QRCodeImg" th:src="@{/images/QRCode/WeChat.png}"></a>
                                    <a target="_blank" href="https://space.bilibili.com/13536815"><img class="QRCodeImg"
                                                                                                       th:src="@{/images/QRCode/Bilibili.png}"></a>
                                    <a target="_blank" href="https://github.com/GoblinCwl"><img class="QRCodeImg"
                                                                                                th:src="@{/images/QRCode/GitHub.png}"></a>
                                </div>
                                <div style="background: #EF9BD5;height: 5px;border-bottom: 1px #000 solid;border-top: 1px #000 solid;"></div>
                                <div>
                                    <div class="web-record">
                                        <p>
                                            © 2022 GoblinCwl 💎
                                            <a href="https://beian.miit.gov.cn/" target="_blank">湘ICP备19013886号</a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <img id="goldImgPick" th:src="@{images/flower/Gold.png}">
            </div>
        </div>


    </div>
</div>

<div id="flowerWateringPop" class="xtiper xtiper_tips xtiper_tips_left xon"
     style="width: 48px; left: 989px; top: 519px; z-index: 99999;visibility: hidden;cursor:pointer"
     title="金盏花想你帮他浇水.."
     onclick="flowerSay()">
    <p style="background-color:white; color:#e1b037;">💧</p>
    <em style="background-color:white;"></em>
</div>
</body>
<div th:replace="fragment/globalComponent::commonFoot(~{::script})">
    <script>
        $(function () {
            //初始化终端
            terminalDataInit();
            //初始化最近更新博客
            recentUpdateBlogDataInit();

            //金盏花眨眼
            setInterval(function () {
                $("#Marigold_blink2").css("visibility", "visible");
                setTimeout(() => {
                    $("#Marigold_blink2").css("visibility", "hidden");
                }, 100)
            }, 2000);


            const arr = ['你好世界！', 'Hello World!', 'こんにちは世界~'];//显示的文本
            const dom = document.getElementById('autoTypeDiv')
            const speed = 0.2;
            let j = 0; //从数组第一个开始展示
            // 递归函数
            const func = (j) => {
                if (j < arr.length) { // 当达到数组长度时，就从头开始继续
                    const item = arr[j]
                    const itemLen = jmz.GetLength(item); // 汉字是占两个ch
                    dom.innerHTML = item; // 显示文字
                    for (var i = 0, len = itemLen; i < len; i++) { // 添加文本效果
                        var textLen = dom.textContent.length, s = dom.style;
                        s.animationTimingFunction = "steps(" + textLen + "),steps(1)"; //动态设置steps
                        s.animationName = `typing${itemLen}`; //文本长度不同，展示的宽度就不同，所以需要动态设置
                        s.animationDuration = `${itemLen * speed}s,` + speed + `s`; //这儿设置速度
                    }
                    setTimeout(() => {
                        //输入完暂停
                        $(dom).css("animation-play-state", "paused");
                        //暂停几秒继续走删除
                        setTimeout(() => {
                            $(dom).css("animation-play-state", "running");
                            //删除需要时间
                            setTimeout(() => {
                                func(j + 1)
                            }, itemLen * speed * 1010 / 2)
                        }, 2000);

                    }, itemLen * speed * 1010 / 2)

                } else {
                    func(0); //就从头开始继续
                }
            }
            func(j);
        });

        const $consoleInput = $("#consoleInput");

        //终端信息初始化
        function terminalDataInit() {
            ajaxHttp({
                type: "GET",
                url: ctx + "/findTerminalData",
                beforeSend: function () {
                    insertMessage("<span style='color: #c0a16b'>数据请求中...</span>", 0);
                },
                error: function () {
                    insertMessage("数据请求失败，有空的话麻烦联系下站长处理~", 50);
                },
                success: function (res) {
                    const data = res.data;
                    insertMessage("您是第<span style='color: orange;font-weight: bold'>" + data.accessIpCount + "</span>个访问本站的地址，站点总计已被访问<span style='color: #3c763d;font-weight: bold'>" + data.accessCount + "</span>次。", 50);
                    insertMessage("同一地址超过半小时后再次访问才会进行次数记录。", 100);
                    insertMessage("认证中...", 200);
                    insertMessage("上次访问: <span style='color: grey'>" + data.lastAccessTime + "</span>.", 800);
                    insertMessage("本次访问: <span style='color: dodgerblue'>" + data.accessTime + "</span>.", 800);
                    if (res.data.lastAccessTime === '首次访问') {
                        insertMessage("根据你的环境，我给你取了个名字：<span style='color: #38c0e2;font-weight: bold'>" + data.nickName + "</span>。✔", 850);
                    } else {
                        insertMessage("<span style='color: #38c0e2;font-weight: bold'>" + data.nickName + "</span>，允许访问！✔", 850);
                    }
                    localStorage.setItem("ipAddress", data.ipAddress);
                    localStorage.setItem("nickName", data.nickName);
                    setTimeout(function () {
                        $("#nickName").text(data.nickName)
                    }, 900);
                    insertMessage("<span style='color: #E74C3C;font-weight: bold'>欢迎来到GoblinCwl的个人网站！</span>", 950);

                    setTimeout(function () {
                        websocketInit()
                    }, 1000)

                    //天气数据
                    $("#provinceSpan").text(data.province);
                    $("#citySpan").text(data.city);
                    $("#weatherTempSpan").text(data.weather + "  " + data.temperature + "℃");
                    $("#stateSpan").text(data.status);
                    $("#weatherTempImg").attr("src", weatherImgJuge(data.weather))

                    //工时数据
                    $("#yesterdayWorkTimeSpan").text("昨工时：" + data.yesterdayWorkTime);
                    $("#todayWorkTimeSpan").text("今工时：" + data.todayWorkTime);

                    //编程语言时间
                    let countTime = data.languagesCountTime;
                    let languageList = data.languages;
                    //换算倍率，把最大值（第一个）换算为百分百，其他按比例乘算
                    let ratioOfConversion = 0;
                    if (languageList != null){
                        for (let i = 0; i < languageList.length; i++) {
                            let $languageDiv = $("#languageDiv" + (i + 1));
                            let $languageSpan = $("#languageSpan" + (i + 1));
                            const language = languageList[i];

                            $languageSpan.text(languageEmoji(language.name));

                            if (ratioOfConversion === 0) {
                                ratioOfConversion = 100 / (language.time / countTime * 100);
                            }

                            let timePercentage = parseFloat(language.time / countTime * 100 * ratioOfConversion + "%");
                            $languageDiv.css("width", timePercentage);
                            $languageDiv.parent().attr("title", language.name + " 过去七天：" + language.timeText);
                            $languageSpan.parent().attr("title", language.name + " 过去七天：" + language.timeText);
                        }
                    }

                    //金盏花浇水次数
                    $("#goldCountSpan").text(PrefixInteger(data.numberOfWatering, 4));

                    //金盏花浇水气泡
                    if ((dateDiffDay(new Date(data.lastWateringTime).Format('yyyy-MM-dd'), new Date().Format('yyyy-MM-dd')) >= 1)) {
                        $("#flowerWateringPop").css("visibility", "visible")
                    } else {
                        $("#flowerWateringPop").css("display", "none")
                    }
                },
                successFalse: function (res) {
                    insertMessage(res.msg, 50);
                    insertMessage("数据请求失败，有空的话麻烦联系下站长处理~", 100);
                }
            });
        }

        //初始化最近更新博客
        function recentUpdateBlogDataInit() {
            ajaxHttp({
                type: "GET",
                url: ctx + "/blog/recentUpdateList",
                success: function (res) {
                    const dataList = res.data.records;
                    let htmlStr = "";
                    for (const data of dataList) {
                        const title = reLengthStr(data.title, 28);
                        let icon = '';
                        let iconTitle = '';
                        if (data.updateTime === data.releaseTime) {
                            icon = '🌟';
                            iconTitle = '新发布!';
                        } else {
                            icon = '🔔';
                            iconTitle = '有更新';
                        }
                        htmlStr += "<tr>\n" +
                            "<td><span title='" + iconTitle + "'>" + icon + "</span>" +
                            "<a title='" + data.title + "' href='/blog/content/" + data.id + "'>" + title + "</a></td>" +
                            "<td class='blogTdTime'><span title='更新时间：" + data.updateTime + "'>" + dateDif(new Date(data.updateTime).getTime()) + "</span></td>" +
                            "</tr>";
                    }
                    $("#updateBlogTbody").html(htmlStr)
                }
            });
        }

        //websocket初始化
        function websocketInit() {
            const webSocket = new WebSocket(projectHomeWebSocketUrl + "/terminal");
            webSocket.onerror = function (event) {
                insertMessage("<span style='color: red'>连接发生异常，信息如下：❌</span>");
                insertMessage("<span style='color: red'>" + event.data + "</span>");
                insertMessage("<span style='color: red'>尝试刷新或联系站长处理！❌</span>");
            };
            //与WebSocket建立连接
            webSocket.onopen = function (event) {
                insertMessage("<span style='color: #c0a16b'>正在连接到聊天室...</span>");
            };
            //处理服务器返回的信息
            webSocket.onmessage = function (event) {
                let nowMessage = event.data;
                if (nowMessage.indexOf("{") === 0) {
                    const msgJson = JSON.parse(nowMessage);
                    const time = "<span style='color: #929e98'>[" + msgJson.sendTime + "]</span>";
                    let contentColor = msgJson.color;
                    if (contentColor == null) {
                        contentColor = randomColor();
                    }
                    const message = "<span style='color: " + contentColor + "'>" + msgJson.content + "</span>";
                    $consoleInput.before(time + " " + message + "<br>");
                } else {
                    insertMessage(nowMessage);
                }
                $('#terminal-console').scrollTop($('#terminal-console')[0].scrollHeight);
            };

            function sendMessage(message) {
                //向服务器发送消息
                if (message.indexOf("/login") > 0) {
                    //如果是/login开头，则是管理员登陆
                    let password = message.substr(message.lastIndexOf(" ") + 1);
                    ajaxHttp({
                        type: 'POST',
                        url: ctx + "/manager/login",
                        data: {
                            "password": password
                        },
                        error: function () {
                            insertMessage("<span style='color: red'>登陆异常！❌</span>");
                        },
                        success: function (res) {
                            if (res.code === 200) {
                                //设置Token
                                localStorage.setItem("access_token", res.data);
                                insertMessage("<span style='color: green'>登陆成功！✔</span>");
                                addManagerUl();
                            } else {
                                insertMessage("<span style='color: red'>" + res.msg + "❌</span>");
                            }
                        }
                    })
                } else if (message.indexOf("/logout") > 0) {
                    //登出
                    ajaxHttp({
                        type: 'GET',
                        url: ctx + "/manager/logout",
                        error: function () {
                            insertMessage("<span style='color: red'>登出异常！❌</span>");
                        },
                        success: function (res) {
                            if (res.code === 200) {
                                insertMessage("<span style='color: #acac40'>登出成功！✔</span>");
                                $('#managerLi').remove();
                                document.cookie = "Authorization=null";
                                localStorage.setItem("access_token", "");
                            } else {
                                insertMessage("<span style='color: red'>" + res.msg + "❌</span>");
                            }
                        }
                    })
                } else {
                    webSocket.send(message);
                }
            }

            const $chatInput = $("#chatInput");

            //动态设置输入框的宽度
            $chatInput.width(($("#terminalDiv").width() - $("#chatInputLabel").width()) * 0.9)

            //监听终端点击
            $("#terminal-console").click(function () {
                $chatInput.focus();
            });

            //监听回车
            var time = 0;
            $chatInput.keydown(function (event) {
                const code = event.keyCode;
                //按下回车时
                if (code === 13) {
                    const message = $("#nickName").text() + ': ' + $chatInput.val();
                    //校验信息长度
                    if ($chatInput.val().length > 50) {
                        insertMessage("<span style='color: red'>太多啦，我们还是长话短说吧！🎤</span>")
                    } else if ($chatInput.val().length > 0) {
                        //判断计时器是否处于关闭状态
                        if (time === 0) {
                            time = 5; //设定间隔时间（秒）

                            //启动计时器，倒计时time秒后自动关闭计时器。
                            var index = setInterval(function () {
                                time--;
                                if (time === 0) {
                                    clearInterval(index);
                                }
                            }, 1000);

                            //发送消息
                            sendMessage(message);
                            $chatInput.val('');
                        } else {
                            insertMessage("<span style='color: red'>喝口茶歇歇吧，" + time + "秒就好！☕</span>")
                        }
                    }
                }
            })
        }

        //追加终端信息
        function insertMessage(message, time) {
            const $terminalConsole = $('#terminal-console');
            if (time != null) {
                setTimeout(function () {
                    $consoleInput.before(getMessageTimestamp() + message + "<br>");
                }, time);
            } else {
                $consoleInput.before(getMessageTimestamp() + message + "<br>");
            }
            $terminalConsole.scrollTop($terminalConsole[0].scrollHeight);
        }

        //获取当前时间轴
        function getMessageTimestamp() {
            return "<span class='timeStampSHow'>"
                + "["
                + new Date().Format("MM-dd HH:mm")
                + "] "
                + "</span>";
        }

        //计算时间差，获取模糊中文时间
        function dateDif(startDate) {
            const date = new Date().getTime() - startDate;
            const days = date / 1000 / 60 / 60 / 24;
            const daysRound = Math.floor(days);
            const hours = date / 1000 / 60 / 60 - (24 * daysRound);
            const hoursRound = Math.floor(hours);
            const minutes = date / 1000 / 60 - (24 * 60 * daysRound) - (60 * hoursRound);
            const minutesRound = Math.floor(minutes);
            const seconds = date / 1000 - (24 * 60 * 60 * daysRound) - (60 * 60 * hoursRound) - (60 * minutesRound);
            const secondsRound = Math.floor(seconds);
            const time = (daysRound + "天" + hoursRound + "时" + minutesRound + "分" + secondsRound + "秒");
            if (daysRound > 0) {
                return daysRound + "天前";
            }
            if (hoursRound > 0) {
                return hoursRound + "小时前";
            }
            if (minutesRound > 0) {
                return minutesRound + "分钟前";
            }
            if (secondsRound > 0) {
                return "刚刚";
            }
        }

        //判断天气图片
        function weatherImgJuge(weather) {
            console.log(weather)
            switch (weather) {
                case "平静":
                    weatherImg = "日";
                    break;
                case "晴":
                case "晴天":
                case "热":
                    weatherImg = "晴天";
                    break;
                case "少云":
                case"晴间多云":
                case"多云":
                    weatherImg = "多云";
                    break;
                case "阴":
                    weatherImg = "阴天";
                    break;
                case "有风":
                case "微风":
                case "和风":
                case "清风":
                case "冷":
                    weatherImg = "阴天-风";
                    break;
                case "强风/劲风":
                case "疾风":
                case "大风":
                case "烈风":
                case "风暴":
                case "狂爆风":
                case "飓风":
                case "热带风暴":
                case "龙卷风":
                    weatherImg = "大风";
                    break;
                case "霾":
                case "中度霾":
                case "重度霾":
                case "严重霾":
                    weatherImg = "雾霾";
                    break;
                case "阵雨":
                case "小雨":
                case "中雨":
                case "毛毛雨/细雨":
                case "雨":
                case "小雨-中雨":
                case "中雨-大雨":
                    weatherImg = "小雨";
                    break;
                case "大雨":
                case "暴雨":
                case "大暴雨":
                case "特大暴雨":
                case "强阵雨":
                case "极端降雨":
                case "大雨-暴雨":
                case "暴雨-大暴雨":
                case "大暴雨-特大暴雨":
                    weatherImg = "大雨";
                    break;
                case "雷阵雨":
                case "强雷阵雨":
                    weatherImg = "雷阵雨";
                    break;
                case "雨夹雪":
                case "阵雨夹雪":
                case "冻雨":
                case "雨雪天气":
                    weatherImg = "雨夹雪";
                    break;
                case "雷阵雨并伴有冰雹":
                    weatherImg = "冰雹";
                    break;
                case "雪":
                case "阵雪":
                case "小雪":
                case "中雪":
                case "小雪-中雪":
                case "中雪-大雪":
                case "大雪-暴雪":
                    weatherImg = "小雪";
                    break;
                case "大雪":
                case "暴雪":
                    weatherImg = "大雪";
                    break;
                case "雾":
                case "浓雾":
                case "强浓雾":
                case "轻雾":
                case "大雾":
                case "特强浓雾":
                    weatherImg = "雾";
                    break;
                default:
                    weatherImg = "未知";
            }
            return ctx + "/images/weather/" + weatherImg + ".png";
        }

        //匹配语言表情
        function languageEmoji(language) {
            let emoji;
            switch (language) {
                case "Java":
                    emoji = "♨️";
                    break;
                case "HTML":
                    emoji = "🖥️";
                    break;
                case "JavaScript":
                    emoji = "👣";
                    break;
                case "CSS":
                    emoji = "🦋";
                    break;
                case "HTTP Request":
                    emoji = "🤝";
                    break;
                case "XML":
                    emoji = "🏷️";
                    break;
                case "Web Test":
                    emoji = "📗";
                    break;
                case "SQL":
                    emoji = "🐬";
                    break;
                default:
                    emoji = "❓";
            }
            //长度判断
            if (jmz.GetLength(language) > 5) {
                language = language.substr(0, 4) + "..";
            }
            return emoji + language;
        }

        //金盏花浇水
        function flowerSay() {
            //隐藏浇水气泡
            $("#flowerWateringPop").css("display", "none")
            //掉落金锭
            $("#goldImgPick").css("visibility", "visible");

            ajaxHttp({
                type: "GET",
                url: ctx + "/watering",
                success: function (res) {
                    xtip.tips(res.data, 'goldCountSpan', {
                        times: 3,
                        pos: 'l',
                        bgcolor: 'white',
                        color: '#e1b037',
                    });

                    //金锭+1
                    $("#goldImgPick").css("animation-play-state", "running");
                    $("#goldCountSpan").text(PrefixInteger(parseInt($("#goldCountSpan").text()) + 1, 4));
                }
            });


        }

    </script>
    <!--手表时钟-->
    <script th:src="@{/plugins/watchClock/script.js}" type="text/javascript"></script>
</div>
</html>