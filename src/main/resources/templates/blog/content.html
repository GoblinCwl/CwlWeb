<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="zh">
<head th:replace="fragment/globalComponent::commonHead(~{::title},~{},~{::link})">
    <link rel="stylesheet" th:href="@{/plugins/editormd/css/editormd.preview.css}">
    <title>GoblinCwl - 博客</title>
</head>
<body>
<!-- 左侧侧边栏 -->
<div th:replace="fragment/blogComponent::leftSiderBar"></div>

<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <div class="content">
        <!-- 顶部导航 -->
        <div th:replace="fragment/globalComponent::topHeader"></div>

        <div class="container" style="margin-top: 2em;margin-left: 2em;width: 100%;padding-right: 4em">
            <div class="header">
                <h2 id="contentTitle"></h2>
            </div>
            <div class="footer">
                <div id="view-editormd"></div>
            </div>
        </div>

    </div>
</div>
<div th:replace="fragment/globalComponent::commonFoot(~{::script})">
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/marked.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/prettify.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/raphael.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/underscore.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/sequence-diagram.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/flowchart.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/lib/jquery.flowchart.min.js}"></script>
    <script type="text/javascript" th:src="@{/plugins/editormd/editormd.min.js}"></script>

    <script type="text/javascript" th:inline="javascript">
        let editorMdView;

        $(function () {
            ajaxHttp({
                type: "GET",
                url: ctx + "/blog/" + $.getUrlParam("id"),
                success: function (res) {
                    if (res != null && res.code === 200) {
                        $("title").html(res.data.title);
                        $("#contentTitle").text(res.data.title)
                        if (res.data.content == null) {
                            res.data.content = '';
                        }
                        editorMdView = editormd.markdownToHTML("view-editormd", {
                            markdown: res.data.content,
                            //htmlDecode      : true,       // 开启 HTML 标签解析，为了安全性，默认不开启
                            htmlDecode: "style,script,iframe", // you can filter tags decode
                            //toc             : false,
                            tocm: true, // Using [TOCM]
                            //tocContainer    : "#custom-toc-container", // 自定义 ToC 容器层
                            //gfm             : false,
                            //tocDropdown     : true,
                            // markdownSourceCode : true, // 是否保留 Markdown 源码，即是否删除保存源码的 Textarea 标签
                            emoji: true,
                            taskList: true,
                            tex: true, // 默认不解析
                            flowChart: true, // 默认不解析
                            sequenceDiagram: true, // 默认不解析
                        })
                    } else {
                        xtip.msg(res.msg, {icon: 'e', type: 'w'});
                    }
                },
            });
        });
    </script>
</div>
</body>
</html>